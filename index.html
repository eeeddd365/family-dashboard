<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Xitun Premium Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;300;400;700&display=swap" rel="stylesheet">
    <style>
        body {
            background: #020617;
            color: #f1f5f9;
            font-family: 'Noto Sans TC', sans-serif;
            overflow: hidden; /* åš´æ ¼ç¦æ­¢æ²è»¸ */
            cursor: none;
        }
        .glass {
            background: rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 2.5rem;
        }
        .text-neon { text-shadow: 0 0 25px rgba(56, 189, 248, 0.4); }
        iframe { transition: opacity 0.5s ease-in-out; }
        .camera-container::after {
            content: "LIVE CAMERA";
            position: absolute; top: 10px; left: 10px;
            background: rgba(220, 38, 38, 0.8);
            padding: 2px 8px; border-radius: 4px;
            font-size: 10px; font-weight: bold;
        }
    </style>
</head>
<body class="h-screen w-screen p-6 grid grid-cols-12 grid-rows-6 gap-5">

    <div class="col-span-5 row-span-4 glass flex flex-col justify-center items-center">
        <div id="clock" class="text-[11rem] font-thin leading-none tracking-tighter text-neon">00:00</div>
        <div class="mt-4 text-center">
            <span id="date" class="text-3xl font-light text-slate-300">2026å¹´2æœˆ1æ—¥</span>
            <span id="lunar" class="text-2xl text-amber-200/60 block mt-2 font-light">è¾²æ›† è¼‰å…¥ä¸­...</span>
        </div>
    </div>

    <div class="col-span-7 row-span-2 glass px-10 flex items-center justify-between">
        <div class="flex items-center gap-6">
            <div id="weather-icon" class="text-7xl">â˜€ï¸</div>
            <div>
                <p class="text-sky-400 text-sm tracking-widest">è¥¿å±¯å€ é’æµ·è·¯</p>
                <div id="temp" class="text-7xl font-bold tracking-tighter">--Â°C</div>
            </div>
        </div>
        <div class="flex gap-10">
            <div class="text-center">
                <p class="text-[10px] text-slate-500 uppercase tracking-widest mb-1">é™é›¨æ©Ÿç‡</p>
                <p id="pop" class="text-3xl font-bold text-sky-400">--%</p>
            </div>
            <div class="text-center">
                <p class="text-[10px] text-slate-500 uppercase tracking-widest mb-1">ä»Šæ—¥é«˜ä½æº«</p>
                <p id="temp-range" class="text-2xl text-slate-300 font-light">-- / --</p>
            </div>
        </div>
    </div>

    <div class="col-span-7 row-span-3 glass p-8 overflow-hidden">
        <h2 class="text-xs font-bold text-slate-500 mb-6 tracking-[0.3em] uppercase flex items-center gap-2">
            <span class="w-1 h-4 bg-red-600 rounded-full"></span> News Headlines
        </h2>
        <div id="news-list" class="space-y-6">
            <p class="text-slate-700 italic">æ­£åœ¨ç²å–é ­æ¢æ–°è...</p>
        </div>
    </div>

    <div class="col-span-3 row-span-2 glass p-8">
        <h2 class="text-xs font-bold text-slate-500 mb-4 tracking-[0.3em] uppercase">Reminders</h2>
        <div class="space-y-3">
            <div class="flex items-center gap-3">
                <div class="w-1.5 h-1.5 bg-amber-400 rounded-full"></div>
                <p class="text-lg text-slate-200">å‡ºé–€è¨˜å¾—å¸¶é›¨å‚˜</p>
            </div>
            <div class="flex items-center gap-3">
                <div class="w-1.5 h-1.5 bg-sky-400 rounded-full"></div>
                <p class="text-lg text-slate-200">19:30 åƒåœ¾è»Šæ™‚é–“</p>
            </div>
        </div>
    </div>

    <div class="col-span-4 row-span-2 glass p-4 flex flex-col relative">
        <div class="flex justify-between items-center mb-2 px-1">
            <span id="cam-label" class="text-[10px] text-slate-500 font-bold uppercase tracking-widest text-blue-400">CAM 1 / 7</span>
            <div class="flex gap-1">
                <div id="dot-1" class="w-1 h-1 bg-white rounded-full opacity-100"></div>
                <div id="dot-2" class="w-1 h-1 bg-white rounded-full opacity-30"></div>
                <div id="dot-3" class="w-1 h-1 bg-white rounded-full opacity-30"></div>
            </div>
        </div>
        <div class="camera-container flex-1 rounded-2xl bg-black overflow-hidden relative shadow-inner">
            <iframe 
                id="cam-frame"
                src="https://tcnvr6.taichung.gov.tw/9db0d761" 
                width="100%" height="100%" 
                style="border:0;"
                sandbox="allow-forms allow-scripts allow-same-origin">
            </iframe>
        </div>
    </div>

    <div class="col-span-5 row-span-1 flex items-center justify-start px-10 text-[10px] text-slate-600 tracking-[0.5em] uppercase">
        System Active â€¢ Xitun Dashboard v3.0
    </div>

    <script>
        const API_KEY = '71530563aac2b604c442ba03e2bf1bd4';
        const LAT = '24.1627'; 
        const LON = '120.6401';
        
        // è·¯æ³å½±åƒæ¸…å–®
        const CAM_URLS = [
            "https://tcnvr6.taichung.gov.tw/9db0d761",
            "https://tcnvr5.taichung.gov.tw/ff2db7f1",
            "https://tcnvr5.taichung.gov.tw/c9ec3cca",
            "https://tcnvr5.taichung.gov.tw/ba31aa33",
            "https://tcnvr5.taichung.gov.tw/98b4f534",
            "https://tcnvr6.taichung.gov.tw/92cb8667"
        ];
        let currentCamIndex = 0;

        function updateTime() {
            const now = new Date();
            document.getElementById('clock').innerText = now.toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit', hour12: false });
            document.getElementById('date').innerText = now.toLocaleDateString('zh-TW', { year: 'numeric', month: 'long', day: 'numeric' });
            const lunarFormatter = new Intl.DateTimeFormat('zh-u-ca-chinese', {day:'numeric', month:'long'});
            document.getElementById('lunar').innerText = `è¾²æ›† ${lunarFormatter.format(now).replace(/å¹´/, '')}`;
        }

        async function fetchWeather() {
            try {
                const res = await fetch(`https://api.openweathermap.org/data/2.5/forecast?lat=${LAT}&lon=${LON}&units=metric&appid=${API_KEY}&lang=zh_tw`);
                const data = await res.json();
                const current = data.list[0];
                document.getElementById('temp').innerText = `${Math.round(current.main.temp)}Â°C`;
                document.getElementById('pop').innerText = `${Math.round(current.pop * 100)}%`;
                const temps = data.list.slice(0, 8).map(i => i.main.temp);
                document.getElementById('temp-range').innerText = `${Math.round(Math.min(...temps))}Â° / ${Math.round(Math.max(...temps))}Â°`;
                const icons = { "Clear": "â˜€ï¸", "Clouds": "â˜ï¸", "Rain": "ğŸŒ§ï¸", "Drizzle": "ğŸŒ¦ï¸", "Thunderstorm": "â›ˆï¸" };
                document.getElementById('weather-icon').innerText = icons[current.weather[0].main] || "â˜€ï¸";
            } catch (e) { console.error(e); }
        }

        async function fetchNews() {
            try {
                const res = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=https://news.pts.org.tw/xml/newsfeed.xml`);
                const data = await res.json();
                document.getElementById('news-list').innerHTML = data.items.slice(0, 4).map(item => `
                    <div class="border-b border-white/5 pb-2">
                        <div class="text-[10px] text-slate-500 font-mono mb-1 uppercase">${new Date(item.pubDate).toLocaleTimeString()}</div>
                        <div class="text-2xl text-slate-200 font-light line-clamp-1">${item.title}</div>
                    </div>
                `).join('');
            } catch (e) { console.error(e); }
        }

        // è¼ªæ’­æ”å½±æ©Ÿ
        function rotateCamera() {
            currentCamIndex = (currentCamIndex + 1) % CAM_URLS.length;
            const frame = document.getElementById('cam-frame');
            frame.style.opacity = 0; // æ·¡å‡º
            setTimeout(() => {
                frame.src = CAM_URLS[currentCamIndex];
                document.getElementById('cam-label').innerText = `CAM ${currentCamIndex + 1} / ${CAM_URLS.length}`;
                frame.style.opacity = 1; // æ·¡å…¥
            }, 500);
        }

        updateTime();
        setInterval(updateTime, 1000);
        fetchWeather();
        setInterval(fetchWeather, 600000);
        fetchNews();
        setInterval(fetchNews, 900000);
        
        // æ¯ 5 ç§’åˆ‡æ›æ”å½±æ©Ÿ
        setInterval(rotateCamera, 5000);

        // æ¯å°æ™‚å…¨é é‡æ•´ï¼Œé˜²æ­¢è¨˜æ†¶é«”æ´©æ¼èˆ‡å½±åƒå¡æ­»
        setTimeout(() => location.reload(), 3600000);
    </script>
</body>
</html>
